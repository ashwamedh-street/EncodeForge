<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<StackPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.ffmpeg.gui.controller.PatternEditorController">
    
    <BorderPane styleClass="dialog-pane" prefWidth="900" prefHeight="650">
        
        <!-- Custom Title Bar -->
        <top>
            <HBox styleClass="custom-title-bar" alignment="CENTER_LEFT">
                <HBox alignment="CENTER_LEFT" spacing="8" styleClass="title-section" 
                      onMousePressed="#handleTitleBarPressed" onMouseDragged="#handleTitleBarDragged">
                    <Label fx:id="appIconLabel" styleClass="app-icon"/>
                    <Label text="Format Pattern Editor" styleClass="app-title"/>
                </HBox>
                
                <Region HBox.hgrow="ALWAYS" onMousePressed="#handleTitleBarPressed" 
                        onMouseDragged="#handleTitleBarDragged" styleClass="draggable-spacer"/>
                
                <HBox spacing="0" styleClass="window-controls">
                    <Button fx:id="minimizeButton" onAction="#handleMinimize" 
                            styleClass="window-control-button, minimize-button"/>
                    <Button fx:id="closeButton" onAction="#handleClose" 
                            styleClass="window-control-button, close-button"/>
                </HBox>
            </HBox>
        </top>
        
        <!-- Main Content -->
        <center>
            <SplitPane dividerPositions="0.35" styleClass="main-split">
                
                <!-- Left: Pattern Type & Presets -->
                <VBox spacing="15" styleClass="sidebar-panel">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>
                    
                    <Label text="Pattern Type" styleClass="section-header"/>
                    <ComboBox fx:id="patternTypeCombo" maxWidth="Infinity" onAction="#handlePatternTypeChange" styleClass="modern-combo"/>
                    
                    <Separator styleClass="modern-separator"/>
                    
                    <Label text="Preset Templates" styleClass="section-header"/>
                    <ListView fx:id="presetsList" VBox.vgrow="ALWAYS" onMouseClicked="#handlePresetSelect" styleClass="modern-list"/>
                    
                    <Button fx:id="loadPresetButton" text="Load Preset" onAction="#handleLoadPreset" styleClass="primary-button" maxWidth="Infinity"/>
                    
                </VBox>
                
                <!-- Right: Editor & Preview -->
                <VBox spacing="15" styleClass="pattern-editor-area">
                    <padding>
                        <Insets top="15" right="15" bottom="15" left="15"/>
                    </padding>
                    
                    <!-- Pattern Editor Section -->
                    <VBox spacing="10" styleClass="content-section">
                        <Label text="Pattern Editor" styleClass="section-header"/>
                        <TextField fx:id="patternField" promptText="Enter your pattern..." 
                                   onKeyReleased="#handlePatternChange" styleClass="pattern-input"/>
                        
                        <!-- Token Buttons -->
                        <VBox spacing="8">
                            <Label text="Insert Tokens:" styleClass="section-label"/>
                            <FlowPane hgap="5" vgap="5">
                                <Button fx:id="titleTokenButton" text="{title}" onAction="#handleInsertToken" styleClass="token-button"/>
                                <Button fx:id="yearTokenButton" text="{year}" onAction="#handleInsertToken" styleClass="token-button"/>
                                <Button fx:id="seasonTokenButton" text="{season}" onAction="#handleInsertToken" styleClass="token-button"/>
                                <Button fx:id="episodeTokenButton" text="{episode}" onAction="#handleInsertToken" styleClass="token-button"/>
                                <Button fx:id="episodeTitleTokenButton" text="{episodeTitle}" onAction="#handleInsertToken" styleClass="token-button"/>
                                <Button fx:id="sTokenButton" text="{S}" onAction="#handleInsertToken" styleClass="token-button"/>
                                <Button fx:id="eTokenButton" text="{E}" onAction="#handleInsertToken" styleClass="token-button"/>
                            </FlowPane>
                        </VBox>
                    </VBox>
                    
                    <Separator/>
                    
                    <!-- Live Preview Section -->
                    <VBox spacing="10" VBox.vgrow="ALWAYS" styleClass="content-section">
                        <Label text="Live Preview" styleClass="section-header"/>
                        
                        <VBox spacing="8" styleClass="preview-container">
                            <Label text="Example 1: TV Show" style="-fx-font-weight: bold; -fx-text-fill: #4ec9b0;"/>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Input:" styleClass="preview-label" minWidth="60"/>
                                <Label fx:id="tvExample1Input" text="Breaking.Bad.S01E01.Pilot.mkv" 
                                       styleClass="preview-text" wrapText="true" HBox.hgrow="ALWAYS"/>
                            </HBox>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Output:" styleClass="preview-label" minWidth="60"/>
                                <Label fx:id="tvExample1Output" text="" 
                                       styleClass="preview-output" wrapText="true" HBox.hgrow="ALWAYS"/>
                            </HBox>
                            
                            <Separator/>
                            
                            <Label text="Example 2: Movie" style="-fx-font-weight: bold; -fx-text-fill: #ce9178;"/>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Input:" styleClass="preview-label" minWidth="60"/>
                                <Label fx:id="movieExample1Input" text="Inception.2010.1080p.mkv" 
                                       styleClass="preview-text" wrapText="true" HBox.hgrow="ALWAYS"/>
                            </HBox>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Output:" styleClass="preview-label" minWidth="60"/>
                                <Label fx:id="movieExample1Output" text="" 
                                       styleClass="preview-output" wrapText="true" HBox.hgrow="ALWAYS"/>
                            </HBox>
                            
                            <Separator/>
                            
                            <Label text="Example 3: Anime" style="-fx-font-weight: bold; -fx-text-fill: #569cd6;"/>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Input:" styleClass="preview-label" minWidth="60"/>
                                <Label fx:id="animeExample1Input" text="[SubGroup]Naruto.E001.mkv" 
                                       styleClass="preview-text" wrapText="true" HBox.hgrow="ALWAYS"/>
                            </HBox>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Output:" styleClass="preview-label" minWidth="60"/>
                                <Label fx:id="animeExample1Output" text="" 
                                       styleClass="preview-output" wrapText="true" HBox.hgrow="ALWAYS"/>
                            </HBox>
                        </VBox>
                    </VBox>
                    
                    <Separator/>
                    
                    <!-- Token Reference -->
                    <VBox spacing="8" styleClass="reference-container">
                        <Label text="Available Tokens" styleClass="section-header"/>
                        <GridPane hgap="15" vgap="5">
                            <Label text="{title}" GridPane.columnIndex="0" GridPane.rowIndex="0" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Show/Movie title" GridPane.columnIndex="1" GridPane.rowIndex="0" styleClass="hint-label"/>
                            
                            <Label text="{year}" GridPane.columnIndex="0" GridPane.rowIndex="1" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Release year" GridPane.columnIndex="1" GridPane.rowIndex="1" styleClass="hint-label"/>
                            
                            <Label text="{season}" GridPane.columnIndex="0" GridPane.rowIndex="2" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Season number (01, 02, etc.)" GridPane.columnIndex="1" GridPane.rowIndex="2" styleClass="hint-label"/>
                            
                            <Label text="{episode}" GridPane.columnIndex="0" GridPane.rowIndex="3" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Episode number (01, 02, etc.)" GridPane.columnIndex="1" GridPane.rowIndex="3" styleClass="hint-label"/>
                            
                            <Label text="{episodeTitle}" GridPane.columnIndex="0" GridPane.rowIndex="4" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Episode title/name" GridPane.columnIndex="1" GridPane.rowIndex="4" styleClass="hint-label"/>
                            
                            <Label text="{S}" GridPane.columnIndex="0" GridPane.rowIndex="5" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Season with 'S' prefix (S01)" GridPane.columnIndex="1" GridPane.rowIndex="5" styleClass="hint-label"/>
                            
                            <Label text="{E}" GridPane.columnIndex="0" GridPane.rowIndex="6" style="-fx-font-family: 'Consolas', monospace; -fx-text-fill: #4ec9b0;"/>
                            <Label text="Episode with 'E' prefix (E01)" GridPane.columnIndex="1" GridPane.rowIndex="6" styleClass="hint-label"/>
                        </GridPane>
                    </VBox>
                    
                </VBox>
                
            </SplitPane>
        </center>
        
        <!-- Bottom: Action Buttons -->
        <bottom>
            <HBox spacing="10" alignment="CENTER_RIGHT" styleClass="dialog-buttons" style="-fx-border-color: #3e3e42; -fx-border-width: 1 0 0 0; -fx-background-color: #252526;">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Button fx:id="resetButton" text="Reset to Default" onAction="#handleReset" styleClass="secondary-button"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="cancelButton" text="Cancel" onAction="#handleCancel" styleClass="secondary-button"/>
                <Button fx:id="applyButton" text="Apply" onAction="#handleApply" styleClass="primary-button"/>
                <Button fx:id="saveButton" text="Save" onAction="#handleSave" styleClass="primary-button" defaultButton="true"/>
            </HBox>
        </bottom>
        
    </BorderPane>
</StackPane>

